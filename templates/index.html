<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KDP PDF Validator</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        /* Branding */
        :root { --amazon-orange:#FF9900; --amazon-dark:#232F3E; --amazon-font:'Amazon Ember',Arial,sans-serif; }
        body { background:#f2f3f5; font-family:var(--amazon-font); padding:2rem; }
        .main-container { max-width:800px; margin:auto; background:#fff; padding:2rem; border:1px solid #e0e0e0; border-radius:4px; }
        .header { background:var(--amazon-dark); color:#fff; padding:1rem; border-radius:4px; display:flex; align-items:center; margin-bottom:1.5rem; }
        .header img { height:40px; margin-right:1rem; }
        .header h1 { margin:0; color:var(--amazon-orange); font-size:1.75rem; }
        .dropzone { border:2px dashed #ccc; border-radius:4px; padding:2rem; text-align:center; background:#fafafa; cursor:pointer; }
        .dropzone:hover { background:#f0f0f0; }
        .analysis-card { background:#fff; border:1px solid #ddd; border-radius:4px; padding:1.5rem; margin-bottom:1.5rem; }
        .analysis-header { display:flex; align-items:center; font-size:1.25rem; margin-bottom:1rem; }
        .analysis-header i { margin-right:0.5rem; }
    </style>
</head>
<body>
    <div class="container main-container">
        <!-- KDP Header -->
        <div class="header bg-amazon-dark d-flex align-items-center mb-4" style="padding:1rem;border-radius:4px;">
            <img src="{{ url_for('static', filename='kdp-logo.png') }}" alt="KDP Logo" style="height:60px;margin-right:1rem;">
            <div>
                <h1 class="text-orange m-0">KDP PDF Validator</h1>
                <p class="lead m-0" style="color:#eaeaea;">Check if your PDF meets KDP's print guidelines</p>
            </div>
        </div>
        <!-- Upload Form -->
        <form id="pdfUploadForm" action="/upload" method="post" enctype="multipart/form-data">
            <div class="analysis-card upload-card">
                <h3 class="analysis-header"><i class="bi bi-file-earmark-pdf-fill"></i> Upload and Validate PDF</h3>
                <div class="dropzone" onclick="document.getElementById('pdfFile').click()">
                    <p>Drag &amp; drop your PDF here</p>
                    <p>or click to select a file</p>
                </div>
                <input type="file" id="pdfFile" name="file" accept="application/pdf" class="d-none" required>

                <div class="mb-3 mt-3">
                    <label for="bookType" class="form-label">Book Type</label>
                    <select class="form-select" id="bookType" name="book_type">
                        <option value="paperback" selected>Paperback</option>
                        <option value="hardcover">Hardcover</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="trimSize" class="form-label">Trim Size</label>
                    <select class="form-select" id="trimSize" name="trim_size" required>
                        <option value="" disabled selected>Choose trim size...</option>
                        {% for size in paperback_trim_sizes %}
                        <option value="{{ size }}">{{ size }} inches</option>
                        {% endfor %}
                        {% for size in hardcover_trim_sizes %}
                        <option value="{{ size }}">{{ size }} inches</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="mb-3">
                    <label for="colorOption" class="form-label">Color Option</label>
                    <select class="form-select" id="colorOption" name="color_option" required>
                        {% for code, name in color_options.items() %}
                        <option value="{{ code }}">{{ name }}</option>
                        {% endfor %}
                    </select>
                </div>

                <button type="submit" class="btn btn-primary w-100 mt-3">Check PDF</button>
            </div>
        </form>

        <!-- Footer -->
        <div class="text-center text-muted mt-3">
            <small>This tool checks your PDF against KDP's print guidelines. <a href="https://kdp.amazon.com/en_US/help/topic/G201834180" target="_blank">KDP Help Center</a></small>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Book Type selection handlers -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      const bookTypeSelect = document.getElementById('bookType');
      const trimSizeSelect = document.getElementById('trimSize');
      const colorOptionSelect = document.getElementById('colorOption');
      const pbSizes = {{ paperback_trim_sizes|tojson }};
      const hcSizes = {{ hardcover_trim_sizes|tojson }};
      bookTypeSelect.addEventListener('change', function() {
        const type = this.value;
        Array.from(trimSizeSelect.options).forEach(opt => {
          if (!opt.value) return;
          const allowed = type === 'paperback' ? pbSizes.includes(opt.value) : hcSizes.includes(opt.value);
          opt.hidden = !allowed;
          opt.disabled = !allowed;
        });
        trimSizeSelect.selectedIndex = 0;
        // Hide standard_color for hardcover
        const stdOpt = colorOptionSelect.querySelector('option[value="standard_color"]');
        if (stdOpt) {
          stdOpt.hidden = (type === 'hardcover');
          stdOpt.disabled = (type === 'hardcover');
          if (type === 'hardcover' && colorOptionSelect.value === 'standard_color') {
            colorOptionSelect.selectedIndex = 0;
          }
        }
      });
      // Trigger on load
      bookTypeSelect.dispatchEvent(new Event('change'));
    });
    </script>
</body>
</html> 